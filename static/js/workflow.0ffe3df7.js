(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["workflow"],{"3fbe":function(e,t,i){"use strict";i("cf36")},b36a:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"workflow"},[i("el-dialog",{attrs:{visible:e.dialogVisible,width:"880px",fullscreen:"","append-to-body":"","close-on-click-modal":!1,"custom-class":"workflow-dialog","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"header-nav",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"header-nav-left"},[i("el-button",{attrs:{size:"mini",icon:"el-icon-arrow-left",circle:""},on:{click:e.handleClose}}),i("label",[e._v(e._s(e.formTitle))])],1),i("el-tabs",{staticClass:"header-nav-center",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"基础设置",name:"basicSetting"}}),i("el-tab-pane",{attrs:{label:"流程设计",name:"processConfig"}})],1),i("div",{staticClass:"header-nav-right"},[i("el-button",{attrs:{size:"mini",round:""},on:{click:e.handleClose}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:e.handleSave}},[e._v("发 布")])],1)],1),i("div",{staticClass:"workflow-body"},[i("basic-setting",{directives:[{name:"show",rawName:"v-show",value:"basicSetting"===e.activeName,expression:"activeName === 'basicSetting'"}],ref:"basicSetting",attrs:{conf:e.basicSetting,"tab-name":"basicSetting","flow-key-options":e.flowKeyOptions,"flow-group-options":e.flowGroupOptions},on:{flowKeyChange:e.flowKeyChange}}),i("process-config",{directives:[{name:"show",rawName:"v-show",value:"processConfig"===e.activeName,expression:"activeName === 'processConfig'"}],ref:"processConfig",attrs:{conf:e.processConfig,"flow-key":e.flowKey,"tab-name":"processConfig"},on:{fetchCondition:e.fetchCondition,fetchUserList:e.fetchUserList,fetchDeptList:e.fetchDeptList,fetchRoleList:e.fetchRoleList}})],1),i("el-dialog",{attrs:{title:"提示",visible:e.tipVisible,"append-to-body":"",width:"520px",top:"20vh","custom-class":"workflow-tip-dialog"},on:{"update:visible":function(t){e.tipVisible=t}}},[i("i",{staticClass:"el-icon-error"}),i("span",{staticClass:"confirm-title"},[e._v("当前无法发布")]),i("div",{staticClass:"confirm-content"},[i("div",[i("p",{staticClass:"error-modal-desc"},[e._v("以下内容不完善，需进行修改")]),i("div",{staticClass:"error-modal-list"},e._l(e.tipList,(function(t,o){return i("div",{key:o,staticClass:"error-modal-item"},[i("div",{staticClass:"error-modal-item-label"},[e._v("流程设计")]),i("div",{staticClass:"error-modal-item-content"},[e._v(e._s(t.name)+" 未选择"+e._s(t.type))])])})),0)])]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.tipVisible=!1}}},[e._v("我知道了")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.tipVisible=!1}}},[e._v("前往修改")])],1)])],1)],1)},n=[],l=(i("d3b7"),i("d81d"),i("3ca3"),i("ddb0"),function(){return new Promise((function(e){setTimeout((function(){return e({})}))}))}),s={pkId:"start",nodeName:"发起人",type:"start",childNode:null,nodeUserList:[]},a={name:"workflow",props:{formTitle:{type:String,default:""},dialogVisible:{type:Boolean,default:!0}},data:function(){return{formData:{},tipList:[],tipVisible:!1,flowKeyOptions:[],flowGroupOptions:[],flowKey:"default",basicSetting:{state:1},formDesignConfig:{},processConfig:{},advancedSetting:{},activeName:"basicSetting",form:{},rules:{},submitDisabled:!1}},computed:{},watch:{dialogVisible:"reset"},created:function(){},mounted:function(){this.reset(),this.fetchFlowKey(),this.fetchFlowGroup()},methods:{reset:function(){if(this.dialogVisible){var e=JSON.parse(JSON.stringify(this.formData));this.nodeConfigDeleteEnd(e.processConfig),this.nodeConfigToArray(e.processConfig),this.flowKey=e.basicSetting?e.basicSetting.flowKey:"default",this.basicSetting=e.basicSetting||{state:1},this.formDesignConfig=e.formDesignConfig||{},this.processConfig=e.processConfig||s,this.advancedSetting=e.advancedSetting||{}}},handleClose:function(){this.$emit("closeDialog",!1)},nodeConfigDeleteEnd:function(e){e&&e.childNode&&("end"===e.childNode.type?e.childNode=null:this.nodeConfigDeleteEnd(e.childNode))},nodeConfigToArray:function(e){var t=this;e&&(e.childNode&&this.nodeConfigToArray(e.childNode),e.conditionNodes&&(e.conditionNodes=e.conditionNodes.map((function(e){t.nodeConfigToArray(e.childNode);try{return e.conditionList=e.conditionList?JSON.parse(e.conditionList):[],e}catch(i){console.log("数据格式不合法：",i)}}))))},flowKeyChange:function(e){this.flowKey=e||"default"},handleSave:function(){var e=this,t=this.$refs["basicSetting"].getData(),i=this.$refs["processConfig"].getData();Promise.all([t,i]).then((function(t){var i={basicSetting:t[0].formData,processConfig:t[1].formData,formDesignConfig:{},advancedSetting:{}};l(i).then((function(){e.$message.success("添加成功"),e.$emit("closeDialog",!0)}))})).catch((function(t){t.target&&(e.activeName=t.target,"processConfig"===t.target&&(e.tipVisible=t.tipList&&t.tipList.length>0,e.tipList=t.tipList))}))},fetchFlowKey:function(){var e=this;return new Promise((function(){setTimeout((function(){e.flowKeyOptions=[{processKey:1,processName:"test1"},{processKey:2,processName:"test2"}]}),300)}))},fetchFlowGroup:function(){var e=this;return new Promise((function(){setTimeout((function(){e.flowGroupOptions=[{id:1,categoryName:"test1"},{id:2,categoryName:"test2"}]}),300)}))},fetchCondition:function(e){return new Promise((function(e){setTimeout((function(){return e([{id:0,processDefinitionKey:null,fieldLabel:"发起人",fieldName:"starterUser",fieldType:"starterUser",canditionOptions:[{label:"包含",value:"in"},{label:"不包含",value:"nin"}],component:"select",dictOptions:null},{id:4,processDefinitionKey:null,fieldLabel:"请假时长",fieldName:"test",fieldType:"number",canditionOptions:[{label:"大于",value:"gt"},{label:"小于",value:"lt"},{label:"等于",value:"eq"},{label:"大于等于",value:"gt_eq"},{label:"小于等于",value:"lt_eq"}],component:"input",dictOptions:null},{id:9,processDefinitionKey:null,fieldLabel:"请假类型",fieldName:"leaveType",fieldType:"array",canditionOptions:[{label:"包含",value:"in"},{label:"不包含",value:"nin"}],component:"select",dictOptions:[{label:"事件",value:"1"},{label:"年假",value:"2"},{label:"病假",value:"3"},{label:"婚假",value:"4"}]},{id:10,processDefinitionKey:null,fieldLabel:"字段1",fieldName:"field01",fieldType:"string",canditionOptions:[{label:"大于",value:"gt"},{label:"小于",value:"lt"},{label:"等于",value:"eq"}],component:"input",dictOptions:null},{id:11,processDefinitionKey:null,fieldLabel:"字段2",fieldName:"field02",fieldType:"date",canditionOptions:[{label:"大于",value:"gt"},{label:"小于",value:"lt"},{label:"等于",value:"eq"}],component:"input",dictOptions:null},{id:12,processDefinitionKey:null,fieldLabel:"字段3",fieldName:"field03",fieldType:"boolean",canditionOptions:[{label:"大于",value:"gt"},{label:"小于",value:"lt"},{label:"等于",value:"eq"}],component:"input",dictOptions:null}])}),300)})).then(e)},fetchUserList:function(e,t){return new Promise((function(t){console.log("fetchUserList",e),setTimeout((function(){return t([{value:1,label:"test1"},{value:2,label:"test2"}])}),300)})).then(t)},fetchDeptList:function(e,t){return new Promise((function(t){console.log("fetchDeptList",e),setTimeout((function(){return t([{value:1,label:"test1"},{value:2,label:"test2"}])}),300)})).then(t)},fetchRoleList:function(e,t){return new Promise((function(t){console.log("fetchRoleList",e),setTimeout((function(){return t([{value:1,label:"test1"},{value:2,label:"test2"}])}),300)})).then(t)}}},c=a,r=(i("3fbe"),i("2877")),f=Object(r["a"])(c,o,n,!1,null,null,null);t["default"]=f.exports},cf36:function(e,t,i){}}]);